<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geothermal Heat Pump Incentive Calculator | Find Your Rebates</title>
    <meta name="description" content="Calculate geothermal heat pump rebates and incentives from utilities across all 50 states. Find your potential savings today.">
    <meta name="keywords" content="geothermal, heat pump, rebates, incentives, calculator, energy efficiency">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .calculator-container {
            display: flex;
            flex-wrap: wrap;
            min-height: 600px;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
        }
        
        .results-section {
            flex: 1;
            min-width: 300px;
            padding: 30px;
            background: white;
            display: flex;
            flex-direction: column;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        button {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .share-btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            margin-top: 20px;
        }

        .share-btn:hover {
            background: linear-gradient(135deg, #219653 0%, #27ae60 100%);
        }
        
        .result-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #3498db;
        }
        
        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #27ae60;
        }
        
        .incentive-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #dee2e6;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .detail-label {
            font-weight: 500;
            color: #6c757d;
        }
        
        .detail-value {
            font-weight: 600;
            color: #495057;
        }
        
        .utility-info {
            background: #e8f4fc;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .utility-name {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .incentive-desc {
            color: #495057;
            line-height: 1.5;
        }
        
        .disclaimer {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #6c757d;
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .privacy-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px;
            font-size: 0.9rem;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 20px;
            display: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .share-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }

        .share-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .share-btn-small {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }

        .share-btn-small:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .share-btn-small.facebook {
            background: linear-gradient(135deg, #3b5998 0%, #2d4373 100%);
        }

        .share-btn-small.twitter {
            background: linear-gradient(135deg, #1da1f2 0%, #0d8bd9 100%);
        }

        .share-btn-small.linkedin {
            background: linear-gradient(135deg, #0077b5 0%, #005885 100%);
        }

        .share-btn-small.email {
            background: linear-gradient(135deg, #ea4335 0%, #d23c30 100%);
        }

        .copy-message {
            margin-top: 10px;
            color: #27ae60;
            font-weight: 600;
            display: none;
        }
        
        @media (max-width: 768px) {
            .calculator-container {
                flex-direction: column;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }

            .share-buttons {
                flex-direction: column;
            }

            .share-btn-small {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Geothermal Heat Pump Incentive Calculator</h1>
            <p class="subtitle">Calculate rebates and savings for geothermal installations</p>
        </header>
        
        <div class="privacy-notice">
            <strong>Privacy Notice:</strong> This calculator runs entirely in your browser. No data is stored on our servers. All calculations happen locally on your device.
        </div>
        
        <div class="error-message" id="errorMessage"></div>
        <div class="loading" id="loadingMessage">Calculating your incentives...</div>
        
        <div class="calculator-container">
            <div class="input-section">
                <h2 class="section-title">Your Information</h2>
                
                <div class="form-group">
                    <label for="state">State</label>
                    <select id="state">
                        <option value="">Select State</option>
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="utility">Utility Company</label>
                    <select id="utility">
                        <option value="">Select State First</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="systemSize">System Size (Tons)</label>
                    <input type="number" id="systemSize" min="1" max="20" step="0.5" value="4" placeholder="Enter system size in tons">
                </div>
                
                <div class="form-group">
                    <label for="systemCost">Estimated System Cost ($)</label>
                    <input type="number" id="systemCost" min="1000" step="100" value="25000" placeholder="Enter total system cost">
                </div>
                
                <div class="form-group">
                    <label for="efficiency">System Efficiency (EER)</label>
                    <input type="number" id="efficiency" min="10" max="40" step="0.1" value="20" placeholder="Enter EER rating">
                </div>
                
                <button id="calculateBtn">Calculate Incentives</button>
                
                <div class="disclaimer">
                    <p>This calculator provides estimates based on available incentive programs. Actual rebates may vary based on specific program requirements and qualifications.</p>
                </div>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">Your Savings</h2>
                
                <div class="result-card">
                    <div class="result-title">Utility Rebate</div>
                    <div class="result-value" id="utilityRebate">$0</div>
                    <div class="incentive-details" id="utilityDetails">
                        <!-- Utility incentive details will appear here -->
                    </div>
                </div>
                
                <div class="result-card">
                    <div class="result-title">State Incentive</div>
                    <div class="result-value" id="stateIncentive">$0</div>
                    <div class="incentive-details" id="stateDetails">
                        <!-- State incentive details will appear here -->
                    </div>
                </div>
                
                <div class="result-card">
                    <div class="result-title">Federal Tax Credit (26%)</div>
                    <div class="result-value" id="federalCredit">$0</div>
                    <div class="incentive-details">
                        <div class="detail-item">
                            <span class="detail-label">System Cost:</span>
                            <span class="detail-value" id="systemCostDisplay">$0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Credit Rate:</span>
                            <span class="detail-value">26%</span>
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <div class="result-title">Total Incentives</div>
                    <div class="result-value" id="totalIncentives">$0</div>
                    <div class="incentive-details">
                        <div class="detail-item">
                            <span class="detail-label">Net System Cost:</span>
                            <span class="detail-value" id="netCost">$0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Percent of Cost Covered:</span>
                            <span class="detail-value" id="percentCovered">0%</span>
                        </div>
                    </div>
                </div>
                
                <div class="utility-info" id="utilityInfo">
                    <!-- Utility information will appear here -->
                </div>

                <!-- Share Section -->
                <div class="share-section" id="shareSection" style="display: none;">
                    <div class="share-title">Share Your Results</div>
                    <div class="share-buttons">
                        <button class="share-btn-small facebook" onclick="shareOnFacebook()">
                            Facebook
                        </button>
                        <button class="share-btn-small twitter" onclick="shareOnTwitter()">
                            Twitter
                        </button>
                        <button class="share-btn-small linkedin" onclick="shareOnLinkedIn()">
                            LinkedIn
                        </button>
                        <button class="share-btn-small email" onclick="shareByEmail()">
                            Email
                        </button>
                        <button class="share-btn-small" onclick="copyToClipboard()">
                            Copy Link
                        </button>
                    </div>
                    <div class="copy-message" id="copyMessage">
                        Link copied to clipboard!
                    </div>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <p><strong>Disclaimer:</strong> This calculator provides estimates based on publicly available incentive programs. Actual rebates may vary based on specific program requirements, qualifications, and available funding. Always verify with your utility provider before making purchase decisions. Program details change frequently - we recommend checking with your utility for the most current information.</p>
            <p>Last updated: December 2024</p>
        </div>
    </div>

    <script>
        // Comprehensive utility data for ALL 50 states
        const utilityData = {
            // Alabama (AL)
            AL: {
                stateIncentive: {
                    name: "AlabamaSAVES Loan Program",
                    value: 0,
                    description: "Low-interest loans for energy efficiency improvements"
                },
                utilities: {
                    "Alabama Power": {
                        type: "Investor-Owned",
                        incentive: "Up to $1,000 rebate",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.2),
                        link: "https://www.alabamapower.com/residential/save-money-and-energy/rebates-and-programs.html"
                    },
                    "TVA - Local Power Companies": {
                        type: "Federal Utility",
                        incentive: "Various rebates available",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.energyright.com/residential/heat-pumps/"
                    }
                }
            },

            // Alaska (AK)
            AK: {
                stateIncentive: {
                    name: "Alaska Housing Energy Efficiency Rebate",
                    value: 0,
                    description: "Home energy rebate program"
                },
                utilities: {
                    "Chugach Electric": {
                        type: "Cooperative",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.chugachelectric.com/save-energy-money/rebates-incentives/"
                    },
                    "Matanuska Electric": {
                        type: "Cooperative",
                        incentive: "Heat pump incentives",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.mea.coop/energy-efficiency/rebates"
                    }
                }
            },

            // Arizona (AZ)
            AZ: {
                stateIncentive: {
                    name: "Arizona Energy Equipment Property Tax Exemption",
                    value: 0,
                    description: "Property tax exemption for renewable energy systems"
                },
                utilities: {
                    "APS - Arizona Public Service": {
                        type: "Investor-Owned",
                        incentive: "Up to $1,500 rebate",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.aps.com/en/Residential/Rebates-Programs"
                    },
                    "SRP - Salt River Project": {
                        type: "Public Power",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.srpnet.com/energy/rebates"
                    },
                    "Tucson Electric Power": {
                        type: "Investor-Owned",
                        incentive: "Residential efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.tep.com/energy-efficiency-programs/"
                    }
                }
            },

            // Arkansas (AR)
            AR: {
                stateIncentive: {
                    name: "Arkansas Energy Performance Contracting",
                    value: 0,
                    description: "Energy efficiency financing programs"
                },
                utilities: {
                    "Entergy Arkansas": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(800, cost * 0.15),
                        link: "https://www.entergy-arkansas.com/your_home/energy_efficiency/"
                    },
                    "SWEPCO - Southwestern Electric Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(750, cost * 0.12),
                        link: "https://www.swepco.com/energy-efficiency/residential/"
                    }
                }
            },

            // California (CA)
            CA: {
                stateIncentive: {
                    name: "California Solar Initiative - Thermal Program",
                    value: 0,
                    description: "Rebates for solar thermal and heat pump systems"
                },
                utilities: {
                    "PG&E - Pacific Gas & Electric": {
                        type: "Investor-Owned",
                        incentive: "Energy upgrade California",
                        calculation: (tons, cost, eer) => Math.min(3000, cost * 0.3),
                        link: "https://www.pge.com/en/rebates-savings/index.page"
                    },
                    "SCE - Southern California Edison": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency incentives",
                        calculation: (tons, cost, eer) => Math.min(2500, cost * 0.25),
                        link: "https://www.sce.com/rebates-savings"
                    },
                    "SDG&E - San Diego Gas & Electric": {
                        type: "Investor-Owned",
                        incentive: "Residential programs",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.2),
                        link: "https://www.sdge.com/residential/rebates-incentives"
                    },
                    "LADWP - Los Angeles Department of Water & Power": {
                        type: "Municipal",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.15),
                        link: "https://www.ladwp.com/rebates"
                    }
                }
            },

            // Colorado (CO)
            CO: {
                stateIncentive: {
                    name: "Colorado Energy Office Rebates",
                    value: 0,
                    description: "State energy efficiency programs"
                },
                utilities: {
                    "Xcel Energy": {
                        type: "Investor-Owned",
                        incentive: "Heat pump rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://co.my.xcelenergy.com/s/residential/heating-cooling/heat-pumps"
                    },
                    "Black Hills Energy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.blackhillsenergy.com/efficiency"
                    },
                    "Holy Cross Energy": {
                        type: "Cooperative",
                        incentive: "Rebates and incentives",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.28),
                        link: "https://www.holycross.com/energy-efficiency/rebates"
                    }
                }
            },

            // Connecticut (CT)
            CT: {
                stateIncentive: {
                    name: "Connecticut Green Bank Programs",
                    value: 0,
                    description: "Energy efficiency financing and rebates"
                },
                utilities: {
                    "Eversource": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(2500, cost * 0.35),
                        link: "https://www.eversource.com/content/residential/save-money-energy/rebates-incentives"
                    },
                    "UI - United Illuminating": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.uinet.com/residential/energy-efficiency-programs"
                    }
                }
            },

            // Delaware (DE)
            DE: {
                stateIncentive: {
                    name: "Delaware Green Energy Program",
                    value: 0,
                    description: "Renewable energy incentives"
                },
                utilities: {
                    "Delmarva Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.delmarva.com/ways-to-save"
                    },
                    "Chester County Electric": {
                        type: "Cooperative",
                        incentive: "Geothermal rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.chestercountyelectric.com/programs"
                    }
                }
            },

            // Florida (FL)
            FL: {
                stateIncentive: {
                    name: "Florida Solar Energy Systems Incentives",
                    value: 0,
                    description: "Property tax abatement for renewable energy"
                },
                utilities: {
                    "FPL - Florida Power & Light": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.fpl.com/energy-saving/programs.html"
                    },
                    "Duke Energy Florida": {
                        type: "Investor-Owned",
                        incentive: "Home energy rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.18),
                        link: "https://www.duke-energy.com/home/rebates"
                    },
                    "Tampa Electric": {
                        type: "Investor-Owned",
                        incentive: "Residential programs",
                        calculation: (tons, cost, eer) => Math.min(900, cost * 0.12),
                        link: "https://www.tampaelectric.com/residential/savings/"
                    }
                }
            },

            // Georgia (GA)
            GA: {
                stateIncentive: {
                    name: "Georgia Clean Energy Property Tax Credit",
                    value: 0,
                    description: "Tax credits for renewable energy systems"
                },
                utilities: {
                    "Georgia Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.georgiapower.com/residential/save-money-and-energy/rebates-and-programs.html"
                    },
                    "Cobb EMC": {
                        type: "Cooperative",
                        incentive: "Heat pump incentives",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.cobbemc.com/for-your-home/rebates"
                    }
                }
            },

            // Hawaii (HI)
            HI: {
                stateIncentive: {
                    name: "Hawaii Energy Rebate Program",
                    value: 0,
                    description: "State energy efficiency rebates"
                },
                utilities: {
                    "Hawaiian Electric": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.35),
                        link: "https://www.hawaiianelectric.com/products-and-services/energy-efficiency"
                    },
                    "Kauai Island Utility": {
                        type: "Cooperative",
                        incentive: "Renewable energy incentives",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.kiuc.coop/energy-efficiency-programs"
                    }
                }
            },

            // Idaho (ID)
            ID: {
                stateIncentive: {
                    name: "Idaho Energy Efficiency Rebates",
                    value: 0,
                    description: "State energy conservation programs"
                },
                utilities: {
                    "Idaho Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.idahopower.com/energy-environment/save-energy/for-your-home/"
                    },
                    "Avista Utilities": {
                        type: "Investor-Owned",
                        incentive: "Residential programs",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.myavista.com/rebates"
                    }
                }
            },

            // Illinois (IL)
            IL: {
                stateIncentive: {
                    name: "Illinois Solar and Wind Energy Program",
                    value: 0,
                    description: "Renewable energy incentives"
                },
                utilities: {
                    "Commonwealth Edison (ComEd)": {
                        type: "Investor-Owned Utilities",
                        incentive: "up to $6,000/home",
                        calculation: (tons, cost, eer) => Math.min(6000, cost * 0.3),
                        link: "https://www.comed.com/WaysToSave/ForYourHome/Pages/Home-Heating-Cooling-Discounts.aspx"
                    },
                    "MidAmerican Energy Company": {
                        type: "Investor-Owned Utilities",
                        incentive: "$900-$1,200/unit",
                        calculation: (tons, cost, eer) => 1050,
                        link: "https://www.midamericanenergy.com/home-discounts-and-rebates#Rebates"
                    },
                    "Ameren Illinois": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.ameren.com/illinois/residential"
                    }
                }
            },

            // Indiana (IN)
            IN: {
                stateIncentive: {
                    name: "Indiana Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Duke Energy Indiana": {
                        type: "Investor-Owned",
                        incentive: "Home energy rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.duke-energy.com/home/rebates/in"
                    },
                    "NIPSCO - Northern Indiana Public Service": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.18),
                        link: "https://www.nipsco.com/save-money-energy/rebates-incentives"
                    }
                }
            },

            // Iowa (IA)
            IA: {
                stateIncentive: {
                    name: "Iowa Energy Center Rebates",
                    value: 0,
                    description: "State energy efficiency programs"
                },
                utilities: {
                    "MidAmerican Energy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.midamericanenergy.com/home-discounts-and-rebates"
                    },
                    "Alliant Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.alliantenergy.com/saveenergyandmoney"
                    }
                }
            },

            // Kansas (KS)
            KS: {
                stateIncentive: {
                    name: "Kansas Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Evergy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1100, cost * 0.2),
                        link: "https://www.evergy.com/save-money/rebates"
                    },
                    "Midwest Energy": {
                        type: "Cooperative",
                        incentive: "Heat pump incentives",
                        calculation: (tons, cost, eer) => Math.min(900, cost * 0.15),
                        link: "https://www.mwenergy.com/energy-efficiency"
                    }
                }
            },

            // Kentucky (KY)
            KY: {
                stateIncentive: {
                    name: "Kentucky Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "LG&E and KU Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy rebates",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.18),
                        link: "https://lge-ku.com/energy-efficiency"
                    },
                    "Big Rivers Electric": {
                        type: "Cooperative",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(800, cost * 0.12),
                        link: "https://www.bigrivers.com/energy-efficiency"
                    }
                }
            },

            // Louisiana (LA)
            LA: {
                stateIncentive: {
                    name: "Louisiana Home Energy Loan Program",
                    value: 0,
                    description: "Energy efficiency financing"
                },
                utilities: {
                    "Entergy Louisiana": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.entergy-louisiana.com/your_home/energy_efficiency/"
                    },
                    "Cleco Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.cleco.com/residential/energy-efficiency"
                    }
                }
            },

            // Maine (ME)
            ME: {
                stateIncentive: {
                    name: "Efficiency Maine Trust",
                    value: 0,
                    description: "Comprehensive energy efficiency programs"
                },
                utilities: {
                    "Versant Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.versantpower.com/save-energy-money"
                    },
                    "Central Maine Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.28),
                        link: "https://www.cmpco.com/energy-savings"
                    }
                }
            },

            // Maryland (MD)
            MD: {
                stateIncentive: {
                    name: "Maryland Energy Administration Programs",
                    value: 0,
                    description: "State energy efficiency incentives"
                },
                utilities: {
                    "Baltimore Gas and Electric": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.bge.com/ways-to-save"
                    },
                    "Pepco": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.25),
                        link: "https://www.pepco.com/ways-to-save"
                    }
                }
            },

            // Massachusetts (MA)
            MA: {
                stateIncentive: {
                    name: "Massachusetts Clean Energy Center",
                    value: 0,
                    description: "Renewable energy and efficiency programs"
                },
                utilities: {
                    "National Grid": {
                        type: "Investor-Owned",
                        incentive: "Heat pump rebates",
                        calculation: (tons, cost, eer) => Math.min(2500, cost * 0.35),
                        link: "https://www.nationalgridus.com/MA-Home/Billing-Payments/Programs-Rebates"
                    },
                    "Eversource": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(2200, cost * 0.32),
                        link: "https://www.eversource.com/content/residential/save-money-energy/rebates-incentives"
                    },
                    "Unitil": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.unitil.com/residential-savings-rebates"
                    }
                }
            },

            // Michigan (MI)
            MI: {
                stateIncentive: {
                    name: "Michigan Energy Office Programs",
                    value: 0,
                    description: "State energy efficiency initiatives"
                },
                utilities: {
                    "Consumers Energy": {
                        type: "Investor-Owned Utilities",
                        incentive: "$300/unit rebate",
                        calculation: (tons, cost, eer) => 300,
                        link: "https://www.consumersenergy.com/-/media/CE/Documents/residential/save-money-and-energy/rebates/hvac/res-programs.pdf"
                    },
                    "DTE Energy": {
                        type: "Investor-Owned Utilities",
                        incentive: "$800/unit rebate",
                        calculation: (tons, cost, eer) => 800,
                        link: "https://www.dteenergy.com/us/en/residential/save-money-energy/rebates-and-offers/air-conditioners.html"
                    },
                    "Great Lakes Energy": {
                        type: "Cooperative",
                        incentive: "Comprehensive geothermal program",
                        calculation: (tons, cost, eer) => Math.min(4500, cost * 0.4),
                        link: "https://www.gtlakes.com/energy-wise/"
                    }
                }
            },

            // Minnesota (MN)
            MN: {
                stateIncentive: {
                    name: "Geothermal Planning Grant Program",
                    value: 0,
                    description: "Planning grant program for geothermal projects"
                },
                utilities: {
                    "Xcel Energy": {
                        type: "Investor-Owned",
                        incentive: "$500/ton rebate",
                        calculation: (tons, cost, eer) => tons * 500,
                        link: "https://co.my.xcelenergy.com/s/residential/heating-cooling/heat-pumps"
                    },
                    "Minnesota Power": {
                        type: "Investor-Owned",
                        incentive: "$1,000/ton rebate",
                        calculation: (tons, cost, eer) => tons * 1000,
                        link: "https://www.mnpower.com/ProgramsRebates/RebatesAndSavings"
                    },
                    "Connexus Energy": {
                        type: "Cooperative",
                        incentive: "$600/ton rebate",
                        calculation: (tons, cost, eer) => tons * 600,
                        link: "https://www.connexusenergy.com/residential/save-money-and-energy/rebates-and-programs/heating-and-cooling"
                    }
                }
            },

            // Mississippi (MS)
            MS: {
                stateIncentive: {
                    name: "Mississippi Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Entergy Mississippi": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.2),
                        link: "https://www.entergy-mississippi.com/your_home/energy_efficiency/"
                    },
                    "Mississippi Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(900, cost * 0.15),
                        link: "https://www.mississippipower.com/residential-savings"
                    }
                }
            },

            // Missouri (MO)
            MO: {
                stateIncentive: {
                    name: "Missouri Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Ameren Missouri": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.ameren.com/missouri/residential"
                    },
                    "Evergy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.evergy.com/save-money/rebates"
                    }
                }
            },

            // Montana (MT)
            MT: {
                stateIncentive: {
                    name: "Montana Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "NorthWestern Energy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.northwesternenergy.com/energy-savings"
                    },
                    "Missoula Electric Cooperative": {
                        type: "Cooperative",
                        incentive: "Heat pump incentives",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.18),
                        link: "https://www.missoulaelectric.org/energy-efficiency"
                    }
                }
            },

            // Nebraska (NE)
            NE: {
                stateIncentive: {
                    name: "Nebraska Energy Office Programs",
                    value: 0,
                    description: "State energy efficiency initiatives"
                },
                utilities: {
                    "Omaha Public Power District": {
                        type: "Public Power",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.24),
                        link: "https://www.oppd.com/rebates"
                    },
                    "Nebraska Public Power District": {
                        type: "Public Power",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.nppd.com/energy-efficiency"
                    }
                }
            },

            // Nevada (NV)
            NV: {
                stateIncentive: {
                    name: "Nevada Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "NV Energy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.nvenergy.com/rebates"
                    },
                    "Las Vegas Valley Water District": {
                        type: "Municipal",
                        incentive: "Water and energy programs",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.lvvwd.com/conservation/rebates.html"
                    }
                }
            },

            // New Hampshire (NH)
            NH: {
                stateIncentive: {
                    name: "New Hampshire Saves Program",
                    value: 0,
                    description: "Energy efficiency and renewable energy programs"
                },
                utilities: {
                    "Eversource": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.32),
                        link: "https://www.eversource.com/content/residential/save-money-energy/rebates-incentives"
                    },
                    "Unitil": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.28),
                        link: "https://www.unitil.com/residential-savings-rebates"
                    }
                }
            },

            // New Jersey (NJ)
            NJ: {
                stateIncentive: {
                    name: "New Jersey Clean Energy Program",
                    value: 0,
                    description: "Comprehensive energy efficiency programs"
                },
                utilities: {
                    "PSE&G": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2200, cost * 0.35),
                        link: "https://www.pseg.com/home/save_money"
                    },
                    "JCP&L": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.jcpl.com/save-money-energy"
                    },
                    "Atlantic City Electric": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.25),
                        link: "https://www.atlanticcityelectric.com/ways-to-save"
                    }
                }
            },

            // New Mexico (NM)
            NM: {
                stateIncentive: {
                    name: "New Mexico Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "PNM - Public Service Company of NM": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.pnm.com/rebates"
                    },
                    "El Paso Electric": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.epelectric.com/energy-efficiency"
                    }
                }
            },

            // New York (NY)
            NY: {
                stateIncentive: {
                    name: "NYSERDA Programs",
                    value: 0,
                    description: "New York State Energy Research and Development Authority"
                },
                utilities: {
                    "Con Edison": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2500, cost * 0.35),
                        link: "https://www.coned.com/en/save-money/rebates-incentives-tax-credits"
                    },
                    "National Grid NY": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(2200, cost * 0.32),
                        link: "https://www.nationalgridus.com/Upstate-NY-Home/Billing-Payments/Programs-Rebates"
                    },
                    "NYSEG": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.3),
                        link: "https://www.nyseg.com/ways-to-save"
                    }
                }
            },

            // North Carolina (NC)
            NC: {
                stateIncentive: {
                    name: "North Carolina Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Duke Energy Carolinas": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.duke-energy.com/home/rebates/nc"
                    },
                    "Dominion Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.25),
                        link: "https://www.dominionenergy.com/savings"
                    }
                }
            },

            // North Dakota (ND)
            ND: {
                stateIncentive: {
                    name: "North Dakota Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Xcel Energy North Dakota": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.xcelenergy.com/energy_savings/rebates_programs"
                    },
                    "Montana-Dakota Utilities": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1100, cost * 0.18),
                        link: "https://www.montana-dakota.com/save-energy-money"
                    }
                }
            },

            // Ohio (OH)
            OH: {
                stateIncentive: {
                    name: "Ohio Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "AEP Ohio": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.26),
                        link: "https://www.aepohio.com/account/billing/rebates/"
                    },
                    "Duke Energy Ohio": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.24),
                        link: "https://www.duke-energy.com/home/rebates/oh"
                    },
                    "FirstEnergy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.firstenergycorp.com/save_energy.html"
                    }
                }
            },

            // Oklahoma (OK)
            OK: {
                stateIncentive: {
                    name: "Oklahoma Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "OG&E": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.oge.com/wps/portal/oge/your-home/rebates-and-programs"
                    },
                    "Public Service Company of OK": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.psoklahoma.com/residential"
                    }
                }
            },

            // Oregon (OR)
            OR: {
                stateIncentive: {
                    name: "Oregon Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Portland General Electric": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.32),
                        link: "https://portlandgeneral.com/rebates"
                    },
                    "Pacific Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.28),
                        link: "https://www.pacificpower.net/save-energy"
                    }
                }
            },

            // Pennsylvania (PA)
            PA: {
                stateIncentive: {
                    name: "Pennsylvania Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "PECO": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.peco.com/ways-to-save"
                    },
                    "FirstEnergy PA": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.25),
                        link: "https://www.firstenergycorp.com/save_energy.html"
                    },
                    "Duquesne Light": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.22),
                        link: "https://www.duquesnelight.com/save-energy-money"
                    }
                }
            },

            // Rhode Island (RI)
            RI: {
                stateIncentive: {
                    name: "Rhode Island Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "National Grid Rhode Island": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.32),
                        link: "https://www.nationalgrid.com/ri-home"
                    }
                }
            },

            // South Carolina (SC)
            SC: {
                stateIncentive: {
                    name: "South Carolina Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Duke Energy Carolinas": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.26),
                        link: "https://www.duke-energy.com/home/rebates/sc"
                    },
                    "Dominion Energy South Carolina": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.24),
                        link: "https://www.dominionenergy.com/savings"
                    }
                }
            },

            // South Dakota (SD)
            SD: {
                stateIncentive: {
                    name: "South Dakota Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Xcel Energy South Dakota": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.xcelenergy.com/energy_savings/rebates_programs"
                    },
                    "Black Hills Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.blackhillsenergy.com/efficiency"
                    }
                }
            },

            // Tennessee (TN)
            TN: {
                stateIncentive: {
                    name: "Tennessee Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "TVA - Local Power Companies": {
                        type: "Federal Utility",
                        incentive: "Various rebates available",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.energyright.com/residential/heat-pumps/"
                    },
                    "Memphis Light, Gas and Water": {
                        type: "Municipal",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.mlgw.com/residential/rebates"
                    }
                }
            },

            // Texas (TX)
            TX: {
                stateIncentive: {
                    name: "Texas Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Oncor": {
                        type: "Transmission Utility",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.26),
                        link: "https://www.oncor.com/en-us/Pages/rebates.aspx"
                    },
                    "CenterPoint Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.24),
                        link: "https://www.centerpointenergy.com/en-us/residential"
                    },
                    "AEP Texas": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.aeptexas.com/ways-to-save"
                    }
                }
            },

            // Utah (UT)
            UT: {
                stateIncentive: {
                    name: "Utah Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Rocky Mountain Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1500, cost * 0.25),
                        link: "https://www.rockymountainpower.net/save-energy"
                    },
                    "Dominion Energy Utah": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.dominionenergy.com/utah"
                    }
                }
            },

            // Vermont (VT)
            VT: {
                stateIncentive: {
                    name: "Efficiency Vermont",
                    value: 0,
                    description: "Comprehensive energy efficiency programs"
                },
                utilities: {
                    "Green Mountain Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2200, cost * 0.35),
                        link: "https://greenmountainpower.com/energy-efficiency/"
                    },
                    "Vermont Electric Co-op": {
                        type: "Cooperative",
                        incentive: "Heat pump incentives",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.32),
                        link: "https://www.vermontelectric.coop/energy-efficiency"
                    }
                }
            },

            // Virginia (VA)
            VA: {
                stateIncentive: {
                    name: "Virginia Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Dominion Energy Virginia": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.dominionenergy.com/virginia"
                    },
                    "Appalachian Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.26),
                        link: "https://www.appalachianpower.com/save"
                    }
                }
            },

            // Washington (WA)
            WA: {
                stateIncentive: {
                    name: "Washington State Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Puget Sound Energy": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(2000, cost * 0.32),
                        link: "https://www.pse.com/rebates"
                    },
                    "Avista Utilities": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.28),
                        link: "https://www.myavista.com/rebates"
                    },
                    "Seattle City Light": {
                        type: "Municipal",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.25),
                        link: "https://www.seattle.gov/light/conserve"
                    }
                }
            },

            // West Virginia (WV)
            WV: {
                stateIncentive: {
                    name: "West Virginia Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Appalachian Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1200, cost * 0.2),
                        link: "https://www.appalachianpower.com/save"
                    },
                    "Mon Power": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1000, cost * 0.15),
                        link: "https://www.firstenergycorp.com/save_energy.html"
                    }
                }
            },

            // Wisconsin (WI)
            WI: {
                stateIncentive: {
                    name: "Focus on Energy Program",
                    value: 0,
                    description: "Wisconsin's energy efficiency and renewable energy program"
                },
                utilities: {
                    "We Energies": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1800, cost * 0.3),
                        link: "https://www.we-energies.com/savings"
                    },
                    "Madison Gas and Electric": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1600, cost * 0.26),
                        link: "https://www.mge.com/saving-energy"
                    },
                    "Xcel Energy Wisconsin": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency programs",
                        calculation: (tons, cost, eer) => Math.min(1400, cost * 0.24),
                        link: "https://www.xcelenergy.com/energy_savings/rebates_programs"
                    }
                }
            },

            // Wyoming (WY)
            WY: {
                stateIncentive: {
                    name: "Wyoming Energy Efficiency Programs",
                    value: 0,
                    description: "State energy conservation initiatives"
                },
                utilities: {
                    "Rocky Mountain Power": {
                        type: "Investor-Owned",
                        incentive: "Energy efficiency rebates",
                        calculation: (tons, cost, eer) => Math.min(1300, cost * 0.22),
                        link: "https://www.rockymountainpower.net/save-energy"
                    },
                    "Black Hills Energy": {
                        type: "Investor-Owned",
                        incentive: "Home energy solutions",
                        calculation: (tons, cost, eer) => Math.min(1100, cost * 0.18),
                        link: "https://www.blackhillsenergy.com/efficiency"
                    }
                }
            }
        };

        // DOM elements
        const stateSelect = document.getElementById('state');
        const utilitySelect = document.getElementById('utility');
        const systemSizeInput = document.getElementById('systemSize');
        const systemCostInput = document.getElementById('systemCost');
        const efficiencyInput = document.getElementById('efficiency');
        const calculateBtn = document.getElementById('calculateBtn');
        const errorMessageEl = document.getElementById('errorMessage');
        const loadingMessageEl = document.getElementById('loadingMessage');
        const shareSection = document.getElementById('shareSection');
        const copyMessage = document.getElementById('copyMessage');

        // Result elements
        const utilityRebateEl = document.getElementById('utilityRebate');
        const stateIncentiveEl = document.getElementById('stateIncentive');
        const federalCreditEl = document.getElementById('federalCredit');
        const totalIncentivesEl = document.getElementById('totalIncentives');
        const netCostEl = document.getElementById('netCost');
        const percentCoveredEl = document.getElementById('percentCovered');
        const utilityDetailsEl = document.getElementById('utilityDetails');
        const stateDetailsEl = document.getElementById('stateDetails');
        const systemCostDisplayEl = document.getElementById('systemCostDisplay');
        const utilityInfoEl = document.getElementById('utilityInfo');

        // Current results for sharing
        let currentResults = {
            state: '',
            utility: '',
            systemSize: 0,
            systemCost: 0,
            utilityRebate: 0,
            stateIncentive: 0,
            federalCredit: 0,
            totalIncentives: 0
        };

        // Share functions
        function getShareableLink() {
            const baseUrl = window.location.href.split('?')[0];
            return baseUrl;
        }

        function getShareMessage() {
            return `I just calculated my geothermal heat pump incentives! 

State: ${currentResults.state}
Utility: ${currentResults.utility}
System: ${currentResults.systemSize} tons

Potential Savings:
 Utility Rebate: $${currentResults.utilityRebate.toLocaleString()}
 State Incentive: $${currentResults.stateIncentive.toLocaleString()}
 Federal Tax Credit: $${currentResults.federalCredit.toLocaleString()}
 TOTAL INCENTIVES: $${currentResults.totalIncentives.toLocaleString()}

Calculate your own savings: ${getShareableLink()}

#Geothermal #HeatPump #EnergySavings #RenewableEnergy`;
        }

        function shareOnFacebook() {
            const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(getShareableLink())}`;
            window.open(url, '_blank', 'width=600,height=400');
        }

        function shareOnTwitter() {
            const text = `I just calculated $${currentResults.totalIncentives.toLocaleString()} in geothermal incentives! Check your savings:`;
            const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(getShareableLink())}`;
            window.open(url, '_blank', 'width=600,height=400');
        }

        function shareOnLinkedIn() {
            const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(getShareableLink())}`;
            window.open(url, '_blank', 'width=600,height=400');
        }

        function shareByEmail() {
            const subject = `My Geothermal Heat Pump Incentives: $${currentResults.totalIncentives.toLocaleString()} in Savings`;
            const body = getShareMessage();
            const url = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = url;
        }

        function copyToClipboard() {
            const message = getShareMessage();
            navigator.clipboard.writeText(message).then(() => {
                copyMessage.style.display = 'block';
                setTimeout(() => {
                    copyMessage.style.display = 'none';
                }, 3000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = message;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                copyMessage.style.display = 'block';
                setTimeout(() => {
                    copyMessage.style.display = 'none';
                }, 3000);
            });
        }

        // Utility functions
        function showError(message) {
            errorMessageEl.textContent = message;
            errorMessageEl.style.display = 'block';
            setTimeout(() => {
                errorMessageEl.style.display = 'none';
            }, 5000);
        }

        function showLoading(show) {
            loadingMessageEl.style.display = show ? 'block' : 'none';
        }

        function validateInputs(state, utility, systemSize, systemCost, efficiency) {
            if (!state) {
                showError('Please select your state');
                return false;
            }
            if (!utility) {
                showError('Please select your utility company');
                return false;
            }
            if (!systemSize || systemSize < 1 || systemSize > 20) {
                showError('Please enter a valid system size between 1 and 20 tons');
                return false;
            }
            if (!systemCost || systemCost < 1000) {
                showError('Please enter a valid system cost (minimum $1,000)');
                return false;
            }
            if (!efficiency || efficiency < 10 || efficiency > 40) {
                showError('Please enter a valid efficiency rating between 10 and 40 EER');
                return false;
            }
            return true;
        }

        // Event listeners
        stateSelect.addEventListener('change', updateUtilityOptions);
        calculateBtn.addEventListener('click', calculateIncentives);

        // Initialize utility options
        function updateUtilityOptions() {
            const state = stateSelect.value;
            utilitySelect.innerHTML = '<option value="">Select Utility</option>';
            
            if (state && utilityData[state]) {
                const utilities = utilityData[state].utilities;
                for (const utilityName in utilities) {
                    const option = document.createElement('option');
                    option.value = utilityName;
                    option.textContent = utilityName;
                    utilitySelect.appendChild(option);
                }
            }
        }

        // Main calculation function
        function calculateIncentives() {
            try {
                const state = stateSelect.value;
                const utilityName = utilitySelect.value;
                const systemSize = parseFloat(systemSizeInput.value);
                const systemCost = parseFloat(systemCostInput.value);
                const efficiency = parseFloat(efficiencyInput.value);

                if (!validateInputs(state, utilityName, systemSize, systemCost, efficiency)) {
                    return;
                }

                showLoading(true);

                setTimeout(() => {
                    const stateData = utilityData[state];
                    const utility = stateData.utilities[utilityName];
                    const stateIncentive = stateData.stateIncentive;

                    const utilityRebate = utility.calculation(systemSize, systemCost, efficiency);
                    const federalCredit = systemCost * 0.26;
                    const stateRebate = stateIncentive.value || 0;

                    const totalIncentives = utilityRebate + federalCredit + stateRebate;
                    const netSystemCost = systemCost - utilityRebate - stateRebate;
                    const percentCovered = (totalIncentives / systemCost) * 100;

                    // Update current results for sharing
                    currentResults = {
                        state: stateSelect.options[stateSelect.selectedIndex].text,
                        utility: utilityName,
                        systemSize: systemSize,
                        systemCost: systemCost,
                        utilityRebate: utilityRebate,
                        stateIncentive: stateRebate,
                        federalCredit: federalCredit,
                        totalIncentives: totalIncentives
                    };

                    // Update UI
                    utilityRebateEl.textContent = `$${utilityRebate.toLocaleString()}`;
                    stateIncentiveEl.textContent = `$${stateRebate.toLocaleString()}`;
                    federalCreditEl.textContent = `$${federalCredit.toLocaleString()}`;
                    totalIncentivesEl.textContent = `$${totalIncentives.toLocaleString()}`;
                    netCostEl.textContent = `$${Math.max(0, netSystemCost).toLocaleString()}`;
                    percentCoveredEl.textContent = `${Math.min(100, percentCovered).toFixed(1)}%`;
                    systemCostDisplayEl.textContent = `$${systemCost.toLocaleString()}`;

                    utilityDetailsEl.innerHTML = `
                        <div class="detail-item">
                            <span class="detail-label">Utility Type:</span>
                            <span class="detail-value">${utility.type}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Rebate Formula:</span>
                            <span class="detail-value">${utility.incentive}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">System Size:</span>
                            <span class="detail-value">${systemSize} tons</span>
                        </div>
                    `;

                    stateDetailsEl.innerHTML = `
                        <div class="detail-item">
                            <span class="detail-label">Program:</span>
                            <span class="detail-value">${stateIncentive.name}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Description:</span>
                            <span class="detail-value">${stateIncentive.description}</span>
                        </div>
                    `;

                    utilityInfoEl.innerHTML = `
                        <div class="utility-name">${utilityName}</div>
                        <p class="incentive-desc">${utility.type} offering ${utility.incentive} for geothermal heat pump installations.</p>
                        <p class="incentive-desc"><a href="${utility.link}" target="_blank">Learn more about this program</a></p>
                    `;

                    // Show share section
                    shareSection.style.display = 'block';

                    showLoading(false);
                }, 500);

            } catch (error) {
                console.error('Calculation error:', error);
                showError('An error occurred during calculation. Please try again.');
                showLoading(false);
            }
        }

        // Initialize the calculator
        document.addEventListener('DOMContentLoaded', function() {
            updateUtilityOptions();
            
            systemSizeInput.addEventListener('input', function() {
                if (this.value < 1) this.value = 1;
                if (this.value > 20) this.value = 20;
            });
            
            systemCostInput.addEventListener('input', function() {
                if (this.value < 1000) this.value = 1000;
            });

            efficiencyInput.addEventListener('input', function() {
                if (this.value < 10) this.value = 10;
                if (this.value > 40) this.value = 40;
            });
        });
    </script>
</body>
</html>
